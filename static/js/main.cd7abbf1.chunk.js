(this["webpackJsonpthreadder-frontend"]=this["webpackJsonpthreadder-frontend"]||[]).push([[0],{137:function(e,t,n){},159:function(e,t,n){},160:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),i=n.n(c),o=n(20),s=n(54),l=n(197),u=n(209),d=n(13),h=n.n(d),f=n(93),j=n.n(f),m=n(101),b={main:"#283845",light:"#395164",dark:"#22303c",contrastText:"#ffffff",contrastText2:"#e5e5e5"},g={paper:b.light,default:"#202c39"},p=Object(m.a)({palette:{primary:b,secondary:{main:"#ffc107",light:"#ffd147",dark:"#c97d02",hover:"#ffa042",inactive:"#432a01",contrastText:"#14213d",inactiveText:"#111111"},background:g},spacing:4,shape:{borderRadius:2}}),x=n(210),O=n(205),w=n(204),v=n(214),y=n(201),T=n(202),C=n(163),N=n(49),S=n(198),k=n(3),F=Object(l.a)((function(e){return{styledButton:{"&:disabled":{color:e.palette.secondary.inactiveText,backgroundColor:e.palette.secondary.inactive},"&:hover":{backgroundColor:e.palette.secondary.hover}}}}));function H(e){var t=F(),n=h()(e.className,t.styledButton);return Object(k.jsx)(S.a,Object(N.a)(Object(N.a)({},e),{},{className:n}))}var I=n(211),L=n(200),E=n(217),z=n(215),A=Object(l.a)((function(e){return{menuList:{border:"solid 1px ".concat(e.palette.primary.dark)}}}));function W(e){var t={paper:A().menuList};return Object(k.jsx)(z.a,Object(N.a)({classes:t},e))}var B=n(218),M=Object(l.a)((function(e){return{menuList:{border:"solid 1px ".concat(e.palette.primary.dark)},menuItem:{color:e.palette.primary.contrastText,"&:hover":{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main}}}}));function R(e){var t=M(),n=Object(a.useState)(null),r=Object(o.a)(n,2),c=r[0],i=r[1],s=function(){i(null)};return Object(k.jsxs)(I.a,{children:[Object(k.jsx)(L.a,{size:"small",onClick:function(e){i(e.currentTarget)},children:Object(k.jsx)(E.a,{src:e.user.profileImage,alt:"".concat(e.user.name," profile picture")})}),Object(k.jsxs)(W,{id:"account-settings-menu",getContentAnchorEl:null,anchorEl:c,anchorReference:"anchorEl",anchorOrigin:{horizontal:"center",vertical:"bottom"},transformOrigin:{horizontal:"center",vertical:"top"},open:Boolean(c),onClose:s,autoFocus:!1,children:[Object(k.jsx)(B.a,{className:t.menuItem,onClick:function(){s();var t=e.user.screenName;window.open("https://twitter.com/".concat(t),"_blank")},children:"Go to Twitter"}),Object(k.jsx)(B.a,{className:t.menuItem,onClick:function(){s(),e.logout()},children:"Log out"})]})]})}var G=Object(l.a)((function(e){return{toolbar:{height:"1em",padding:"1em 1.5em"},title:{flexGrow:1}}}));function P(e){var t=G(),n=Object(k.jsx)(H,{variant:"contained",color:"secondary",onClick:e.login,children:"Log in"});return Object(k.jsx)(y.a,{position:"relative",children:Object(k.jsxs)(T.a,{className:t.toolbar,children:[Object(k.jsx)(C.a,{variant:"h5",className:t.title,children:"Threadder"}),e.loggedIn?Object(k.jsx)(R,{user:e.user,logout:e.logout}):n]})})}var U=n(95),V=n.n(U),J=n(97),_=n.n(J),D=n(96),Z=n.n(D),q=n(203),Y=n(94),$=n(100),K=(n(136),n(137),Object(l.a)((function(e){return{root:{padding:0,marginTop:"0.5em"},toolbarButton:{marginRight:"0.45em",color:e.palette.secondary.dark,"&:hover":{color:e.palette.secondary.main}}}})));function Q(e){var t=K(),n=Object(a.useState)(!1),r=Object(o.a)(n,2),c=r[0],i=r[1];return Object(k.jsxs)("div",{className:t.root,children:[Object(k.jsx)(v.a,{smDown:!0,children:Object(k.jsx)(q.a,{onClickAway:function(){i(!1)},children:Object(k.jsxs)("span",{style:{position:"relative"},children:[c&&Object(k.jsx)($.a,{set:"twitter",data:Y,title:"",emoji:"",showPreview:!1,perLine:8,onSelect:e.pickEmojiHandler}),Object(k.jsx)(L.a,{className:t.toolbarButton,size:"small",onClick:function(){i((function(e){return!e}))},title:"Emoji",children:Object(k.jsx)(V.a,{})})]})})}),Object(k.jsx)(L.a,{className:t.toolbarButton,size:"small",onClick:e.splitTweetHandler,title:"Split",children:Object(k.jsx)(Z.a,{})}),Object(k.jsx)(L.a,{className:t.toolbarButton,size:"small",onClick:e.clearTweetHandler,title:"Clear",children:Object(k.jsx)(_.a,{})})]})}var X=Object(l.a)((function(e){return{root:{flexFlow:"column nowrap"},fullHeight:{height:"100%"},containerWithShadow:{boxShadow:e.shadows[4]},expandingFlexItem:{flex:1},fixedSizeFlexItem:{flex:0},textareaContainer:{display:"flex",flexFlow:"column nowrap",padding:"1.5em",paddingBottom:"0.55em",backgroundColor:e.palette.primary.main},threadTextarea:{fontFamily:"inherit",fontSize:"inherit",resize:"none",width:"100%",padding:"0.5em 0.75em",color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,border:0,boxShadow:"inset 0px 0px 5px 0px rgba(0, 0, 0, 0.4)","&:focus":{border:0,outline:0}},statsContainer:{padding:"1em 1.5em",display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",backgroundColor:e.palette.primary.dark},statsText:{color:e.palette.primary.contrastText2},emojiPicker:{position:"absolute"}}})),ee=r.a.forwardRef((function(e,t){var n=X();return Object(k.jsxs)(w.a,{container:!0,spacing:2,className:h()(n.root,n.fullHeight),children:[Object(k.jsx)(w.a,{item:!0,xs:12,className:h()(n.expandingFlexItem,n.fullHeight),children:Object(k.jsxs)(O.a,{className:h()(n.textareaContainer,n.fullHeight,n.containerWithShadow),children:[Object(k.jsx)("textarea",{className:h()(n.threadTextarea,n.fullHeight),onChange:e.handleTweetInput,onSelect:e.handleCursorPositionChange,placeholder:"Type your tweet here...",value:e.tweetText,ref:t}),Object(k.jsx)(Q,{pickEmojiHandler:e.pickEmojiHandler,splitTweetHandler:e.splitTweetHandler,clearTweetHandler:e.clearTweetHandler})]})}),Object(k.jsx)(w.a,{item:!0,xs:12,className:n.fixedSizeFlexItem,children:Object(k.jsxs)(O.a,{className:h()(n.statsContainer,n.containerWithShadow),children:[Object(k.jsx)(C.a,{variant:"body2",className:n.statsText,children:"Characters: ".concat(e.tweetText.length)}),Object(k.jsx)(C.a,{variant:"body2",className:n.statsText,children:"Tweets: ".concat(e.thread.length)})]})}),Object(k.jsx)(v.a,{mdUp:!0,children:Object(k.jsx)(w.a,{item:!0,xs:12,className:n.fixedSizeFlexItem,children:Object(k.jsx)(H,{variant:"contained",color:"secondary",fullWidth:!0,onClick:e.viewThreadHandler,children:"View thread"})})})]})})),te=n(98);n.n(te).a.config();var ne=280,ae="https://threadder-app.herokuapp.com/",re="Untitled User",ce=Object(l.a)((function(e){return{root:{marginBottom:"1.5em",flexFlow:"row nowrap","&:last-child":{marginBottom:0}},expandingFlexItem:{flex:1},fixedSizeFlexItem:{flex:0},verticalGrid:{display:"flex",flexFlow:"column nowrap"},centerVerticalGridItems:{alignItems:"center"},threadLineContainer:{padding:0},threadLine:{width:"2px",height:"calc(100% + 1.5em)",backgroundColor:e.palette.background.default},tweetContainer:{marginLeft:"1em"},resetFont:{fontFamily:"inherit",fontSize:"inherit"},defaultTextColor:{color:e.palette.primary.contrastText},userName:{fontWeight:"bold"},userHandle:{color:e.palette.primary.contrastText2,marginLeft:"0.5em"},tweetText:{padding:0,margin:0,marginTop:"0.25em",whiteSpace:"pre-wrap",overflowWrap:"break-word"},tweetLength:{width:"100%",textAlign:"left",color:e.palette.secondary.main,margin:0,marginTop:"0.5em"},hiddenOverflow:{overflow:"hidden"}}}));function ie(e){var t=ce(),n=Object(a.useState)("none"),r=Object(o.a)(n,2),c=r[0],i=r[1];return Object(k.jsxs)(w.a,{container:!0,className:t.root,onMouseOver:function(){i("block")},onMouseOut:function(){i("none")},children:[Object(k.jsxs)(w.a,{container:!0,className:h()(t.fixedSizeFlexItem,t.verticalGrid,t.centerVerticalGridItems),children:[Object(k.jsx)(w.a,{item:!0,children:Object(k.jsx)(E.a,{src:e.user.profileImage,alt:"".concat(e.user.name," profile picture")})}),e.threadLine&&Object(k.jsx)(w.a,{item:!0,className:h()(t.expandingFlexItem,t.threadLineContainer),children:Object(k.jsx)("div",{className:t.threadLine})})]}),Object(k.jsxs)(w.a,{container:!0,className:h()(t.expandingFlexItem,t.verticalGrid,t.tweetContainer,t.hiddenOverflow),children:[Object(k.jsxs)(w.a,{item:!0,children:[Object(k.jsx)("span",{className:h()(t.resetFont,t.defaultTextColor,t.userName),children:e.user.name}),Object(k.jsx)("span",{className:h()(t.resetFont,t.userHandle),children:"@".concat(e.user.screenName)})]}),Object(k.jsx)(w.a,{item:!0,children:Object(k.jsx)("p",{className:h()(t.resetFont,t.defaultTextColor,t.tweetText),children:e.text})}),Object(k.jsx)(w.a,{item:!0,style:{display:c},children:Object(k.jsx)("p",{className:h()(t.resetFont,t.tweetLength),children:"".concat(e.text.length,"/").concat(ne)})})]})]})}var oe=Object(l.a)((function(e){return{root:{flexFlow:"column nowrap"},fullHeight:{height:"100%"},containerWithShadow:{boxShadow:e.shadows[4]},expandingFlexItem:{flex:1},fixedSizeFlexItem:{flex:0},autoOverflow:{overflow:"auto"},hiddenOverflow:{overflow:"hidden"},tweetsContainer:{padding:"1.5em",backgroundColor:e.palette.primary.main},buttonRowContainer:{display:"flex",flexFlow:"row nowrap",justifyContent:"space-between",gap:"1em",margin:0,padding:0}}}));function se(e){var t=oe(),n=e.thread.map((function(t,n,a){return Object(k.jsx)(ie,{user:e.user,text:t,threadLine:n+1<a.length},t)}));return Object(k.jsxs)(w.a,{container:!0,spacing:2,className:h()(t.root,t.fullHeight,t.hiddenOverflow),children:[Object(k.jsx)(w.a,{item:!0,xs:12,className:h()(t.expandingFlexItem,t.fullHeight,t.hiddenOverflow),children:Object(k.jsx)(O.a,{className:h()(t.tweetsContainer,t.fullHeight,t.containerWithShadow,t.autoOverflow),children:n})}),Object(k.jsx)(w.a,{item:!0,xs:12,className:t.fixedSizeFlexItem,children:Object(k.jsxs)(O.a,{className:h()(t.buttonRowContainer,t.fullHeight),children:[Object(k.jsx)(v.a,{mdUp:!0,children:Object(k.jsx)(H,{variant:"contained",color:"secondary",fullWidth:!0,onClick:e.editThreadHandler,children:"Edit thread"})}),Object(k.jsx)(H,{variant:"contained",color:"secondary",onClick:e.publishHandler,disabled:!n.length>0,fullWidth:!0,children:"Publish thread"})]})})]})}var le=n(216),ue=n(206),de=n(207),he=Object(l.a)((function(e){return{dialogText:{color:e.palette.primary.contrastText,textAlign:"center"}}}));function fe(e){var t=he();return Object(k.jsx)(le.a,{open:e.open,children:Object(k.jsx)(ue.a,{children:Object(k.jsx)(de.a,{className:t.dialogText,children:e.msg})})})}var je=n(208),me=n(212),be=Object(l.a)((function(e){return{root:{position:"absolute",width:"30%",margin:0,zIndex:1e4,left:"35%",top:0}}}));function ge(e){var t=be();return Object(k.jsx)(je.a,{in:e.visible,className:t.root,children:Object(k.jsx)(me.a,{severity:e.severity,children:e.msg})})}function pe(e){return e.replace(/^[ \t]*/,"").replace(/[ \t]*$/,"")}function xe(e){return e.split(/(\n)/).filter((function(e,t,n){return"\n"!==e||"\n"===e&&"\n"!==n[t]}))}function Oe(e){return e.split(/((?<!\svs?)(?<=\s\w+[a-zA-Z]+)\.(?=\s*[a-zA-Z]+\w*)|(?<=\d+[\s./-]\d+|\s\d+)\.(?=\s*\W*[a-zA-Z]+\w*\W*)|\.$)/g).map((function(e,t,n){return"."===n[t+1]?"".concat(e,"."):"."===e?"":e})).filter((function(e){return""!==e})).map((function(e){return pe(e)}))}function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";if(0===e.length)return[];for(var n=[],a=0;a<e.length;a++)if(0!==a){var r=n.length-1,c=n[r],i=e[a];c.length<=70||c.length+i.length<=ne?(c+=i.startsWith("\n")?i:"".concat(t).concat(i),n[r]=c):n.push(e[a])}else n.push(e[a]);return n}var ve=n(77),ye=n(63);function Te(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];if(0!==n){var r=t.length-1,c=Ne(t[r]);c.length+a.length+1<=ne?t[r]="".concat(c," ").concat(a):t.push(a)}else t.push(a)}return t}function Ce(e){if(e.length<=ne)return e;for(var t=Math.ceil(e.length/277),n=[],a=0;a<t;a++){var r=277*a,c=277*(a+1),i=e.slice(r,c)+"...";n.push(i)}return n}function Ne(e){return"..."===e.slice(e.length-3)?e.slice(0,e.length-3):e}function Se(e){var t=e.trim().split("(---)").map((function(e){return e.trim()})).filter((function(e){return""!==e}));if(ke(t))return t;var n=t.map((function(e){return e.length<=ne?e:function(e){var t=we(xe(e),"\n");return t.every((function(e){return e.length<=ne}))?t:we(t.map((function(e){return e.length<=ne?e:Oe(e)})).flat().map((function(e){return e.trim()})))}(e)})).flat().map((function(e){return e.trim()}));return ke(n)?n:Te(n.map((function(e){return e.length<=ne?e:function(e){if(e.length<=ne)return e;var t,n=e.split(" ").filter((function(e){return 0!==e.length})),a="",r=[],c=Object(ye.a)(n);try{for(c.s();!(t=c.n()).done;){var i=t.value.trim();i.length>ne?(a.length>0&&(r.push("".concat(a,"...")),a=""),r=[].concat(Object(ve.a)(r),Object(ve.a)(Ce(i)))):0===a.length?a+=i:a.length+i.length+1<277?a+=" ".concat(i):(r.push("".concat(a,"...")),a=i)}}catch(s){c.e(s)}finally{c.f()}a.length>0&&r.push(a);var o=r.length-1;return r[o]=Ne(r[o]),r}(e)})).flat().map((function(e){return e.trim()}))).flat().map((function(e){return e.trim()}))}function ke(e){return e.every((function(e){return e.length<=ne}))}function Fe(e){return null!==e&&(t=e,Object.entries(t).length>0)&&function(e,t){var n,a=Object.keys(e),r=Object(ye.a)(t);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(!a.includes(c))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,["name","screenName","profileImage"])&&e.name!==re;var t}var He=n(99),Ie=n.n(He);function Le(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return Ie()({url:e,method:t,withCredentials:!0,baseURL:ae,data:n||{}})}function Ee(e){return"local"===e?localStorage:"session"===e?sessionStorage:void 0}function ze(e,t,n){var a=Ee(e);a&&a.setItem(t,JSON.stringify(n))}function Ae(e,t){var n=Ee(e);if(n)return JSON.parse(n.getItem(t))}var We=Object(l.a)((function(e){return{root:{height:"100vh",maxHeight:"100vh"},gridContainer:{flexFlow:"column nowrap",height:"100%"},appHeader:{flex:0},appView:Object(s.a)({flex:1},e.breakpoints.up("md"),{display:"flex",flexFlow:"row nowrap",gap:e.spacing(1.5)}),mainArea:{height:"100%"},hiddenOverflow:{overflow:"hidden"},loggedInSuccess:{color:e.palette.primary.contrastText,textAlign:"center",fontWeight:"normal"}}}));function Be(e){var t=We(),n={name:re,screenName:"untitled_user",profileImage:""},r=Object(a.useState)(!1),c=Object(o.a)(r,2),i=c[0],s=c[1],l=Object(a.useState)("error"),d=Object(o.a)(l,2),f=d[0],m=d[1],b=Object(a.useState)(""),g=Object(o.a)(b,2),y=g[0],T=g[1],C=Object(a.useState)(!1),N=Object(o.a)(C,2),S=N[0],F=N[1],H=Object(a.useState)("This is an empty dialog"),I=Object(o.a)(H,2),L=I[0],E=I[1],z=Object(a.useState)(Ae("session","loggedIn")||!1),A=Object(o.a)(z,2),W=A[0],B=A[1],M=Object(a.useState)(Ae("session","user")||n),R=Object(o.a)(M,2),G=R[0],U=R[1],V=Object(a.useState)(Ae("session","tweetText")||""),J=Object(o.a)(V,2),_=J[0],D=J[1],Z=Object(a.useState)({start:_.length,end:_.length}),q=Object(o.a)(Z,2),Y=q[0],$=q[1],K=Object(a.useState)([]),Q=Object(o.a)(K,2),X=Q[0],te=Q[1],ne=Object(a.useState)(!0),ae=Object(o.a)(ne,2),ce=ae[0],ie=ae[1],oe=Object(a.createRef)(),le=function(e){var t=function(e,t,n){return[e.slice(0,t.start)+n+e.slice(t.end),t.start+n.length]}(_,Y,e),n=Object(o.a)(t,2),a=n[0],r=n[1];$({start:r,end:r}),D(a)},ue=function(){ie(!ce)},de=function(){me("Please wait while we try to log you into your account"),Le("/request_token","get").then((function(e){document.location.href=e.data.redirect})).catch((function(e){console.log(e),pe("error","string"===typeof e?e:"Login failed")})).finally(be)},he=Object(a.useCallback)((function(){me("Hold tight while we publish your thread"),function(e){return Le("/publish_thread","post",{tweets:e})}(X).then((function(){pe("success","Thread published successfully"),D("")})).catch((function(e){console.log(e),pe("error","string"===typeof e?e:"Failed to publish your thread")})).finally(be)}),[X]),je=Object(a.useCallback)((function(){Ae("session","publishAfterLogin")&&(ze("session","publishAfterLogin",!1),he())}),[he]),me=function(e){E(e),F(!0)},be=function(){F(!1)},pe=function(e,t){s(!0),m(e),T(t)};return Object(a.useEffect)((function(){Ae("session","loginSuccessMessage")?(ze("session","loginSuccessMessage",!1),pe("success","You are now logged in")):Ae("session","loginFailMessage")&&(ze("session","loginFailMessage",!1),pe("error","Login failed"))}),[]),Object(a.useEffect)((function(){if(""!==document.location.search){var e=j.a.parse(document.location.search);document.location.search="",Fe(e)?(B(!0),U(e),ze("session","loginSuccessMessage",!0)):ze("session","loginFailMessage",!0)}}),[je]),Object(a.useEffect)((function(){oe.current&&(oe.current.selectionStart=Y.start,oe.current.selectionEnd=Y.end)})),Object(a.useEffect)((function(){oe.current&&oe.current.focus()}),[oe]),Object(a.useEffect)((function(){ze("session","loggedIn",W)}),[W]),Object(a.useEffect)((function(){ze("session","user",G)}),[G]),Object(a.useEffect)((function(){0===_.length?te([]):te(Se(_)),ze("session","tweetText",_)}),[_]),Object(a.useEffect)((function(){ze("session","thread",X)}),[X]),Object(a.useEffect)((function(){var e;if(i)return e&&clearTimeout(e),e=setTimeout((function(){s(!1)}),3e3),function(){return clearTimeout(e)}}),[i]),Object(k.jsx)(u.a,{theme:p,children:Object(k.jsxs)(x.a,{children:[Object(k.jsx)(ge,{visible:i,severity:f,msg:y}),Object(k.jsx)(fe,{open:S,msg:L}),Object(k.jsx)(O.a,{className:t.root,children:Object(k.jsxs)(w.a,{container:!0,spacing:3,className:t.gridContainer,children:[Object(k.jsx)(w.a,{item:!0,xs:12,className:t.appHeader,children:Object(k.jsx)(P,{user:G,loggedIn:W,login:de,logout:function(){Le("/logout","get").then((function(){pe("success","You are now logged out"),B(!1),U(n)})).catch((function(e){console.log(e),pe("error","string"===typeof e?e:"Logout failed")}))}})}),Object(k.jsxs)(w.a,{item:!0,xs:12,className:h()(t.appView,t.hiddenOverflow),children:[Object(k.jsx)(v.a,{smDown:!ce,children:Object(k.jsx)(w.a,{item:!0,xs:12,md:7,className:h()(t.mainArea,t.hiddenOverflow),children:Object(k.jsx)(ee,{tweetText:_,handleTweetInput:function(e){var t=e.target.value;D(t),$({start:e.target.selectionStart,end:e.target.selectionEnd})},handleCursorPositionChange:function(e){var t=e.target.selectionStart,n=e.target.selectionEnd;$({start:t,end:n})},pickEmojiHandler:function(e){le(e.native)},splitTweetHandler:function(){le("\n(---)\n")},clearTweetHandler:function(){D("")},thread:X,viewThreadHandler:ue,ref:oe})})}),Object(k.jsx)(v.a,{smDown:ce,children:Object(k.jsx)(w.a,{item:!0,xs:12,md:5,className:h()(t.mainArea,t.hiddenOverflow),children:Object(k.jsx)(se,{user:G,thread:X,editThreadHandler:ue,publishHandler:function(){W?he():(ze("session","publishAfterLogin",!0),de())}})})})]})]})})]})})}n(159);i.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(Be,{})}),document.querySelector("#root"))}},[[160,1,2]]]);
//# sourceMappingURL=main.cd7abbf1.chunk.js.map